<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <title>Giviso Neural Storage Master - V13</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://unpkg.com/vis-network/standalone/umd/vis-network.min.js"></script>
    <link href="https://fonts.googleapis.com/css2?family=Orbitron:wght@400;700&family=Inter:wght@400;600&display=swap" rel="stylesheet">
    <style>
        :root { --cyan: #06b6d4; --bg: #050508; }
        body { background: var(--bg); color: #e2e8f0; font-family: 'Inter', sans-serif; overflow: hidden; height: 100vh; }
        .glass-panel { background: rgba(0, 0, 0, 0.85); backdrop-filter: blur(25px); border: 1px solid rgba(255, 255, 255, 0.1); }
        #network-container { width: 100vw; height: 100vh; background: radial-gradient(circle at center, #0d112d 0%, #050508 100%); }
        /* T√πy ch·ªânh m√†u s·∫Øc theo lo·∫°i */
        .color-student { color: #22c55e; } /* Xanh l√° */
        .color-tech { color: #f97316; }    /* Cam */
        .color-language { color: #a855f7; } /* T√≠m */
    </style>
</head>
<body>

    <div class="fixed top-24 right-8 z-50 flex flex-col gap-2 glass-panel p-4 rounded-2xl border-r-2 border-cyan-500">
        <p class="text-[8px] text-gray-500 uppercase font-bold mb-2 tracking-widest">Ph√¢n lo·∫°i kho</p>
        <button onclick="setNodeType('#22c55e')" class="w-full py-1 px-3 text-[9px] bg-green-500/10 text-green-500 rounded border border-green-500/20 hover:bg-green-500 hover:text-white transition">H·ªçc sinh</button>
        <button onclick="setNodeType('#f97316')" class="w-full py-1 px-3 text-[9px] bg-orange-500/10 text-orange-500 rounded border border-orange-500/20 hover:bg-orange-500 hover:text-white transition">C√¥ng ngh·ªá</button>
        <button onclick="setNodeType('#a855f7')" class="w-full py-1 px-3 text-[9px] bg-purple-500/10 text-purple-500 rounded border border-purple-500/20 hover:bg-purple-500 hover:text-white transition">Ngo·∫°i ng·ªØ</button>
    </div>

    <div id="network-container"></div>
    <script>
        // --- D·ªØ li·ªáu n√¢ng c·∫•p ---
        let nodes = new vis.DataSet(JSON.parse(localStorage.getItem('brain_v13_nodes')) || [{ id: Date.now(), label: 'GIVISO_MASTER', color: '#06b6d4' }]);
        let edges = new vis.DataSet(JSON.parse(localStorage.getItem('brain_v13_edges')) || []);
        let selectedNodeId = null;

        const network = new vis.Network(document.getElementById('network-container'), { nodes, edges }, {
            nodes: { shape: 'dot', font: { color: '#ffffff', face: 'Inter' }, borderWidth: 2, shadow: true },
            edges: { color: 'rgba(6, 182, 212, 0.25)', arrows: 'to', smooth: true, dashes: { enabled: true, speed: 5 } },
            physics: { enabled: true, barnesHut: { gravitationalConstant: -5000, springLength: 180 } }
        });

        // H√ÄM PH√ÇN LO·∫†I M√ÄU CHO KHO
        function setNodeType(color) {
            if (!selectedNodeId) return alert("Th·∫ßy h√£y ch·ªçn 1 n√∫t ƒë·ªÉ ph√¢n lo·∫°i!");
            nodes.update({ id: selectedNodeId, color: color });
            saveData();
        }

        // T·ª∞ ƒê·ªòNG PH√ÅT HI·ªÜN LINK TRONG KHO
        function updateNote(id) {
            const noteText = document.getElementById('node-note').value;
            let labelSuffix = "";
            if (noteText.includes('http')) labelSuffix = " üîó"; // T·ª± ƒë·ªông th√™m icon n·∫øu c√≥ link
            
            const originalLabel = nodes.get(id).label.replace(" üîó", "");
            nodes.update({ id, note: noteText, label: originalLabel + labelSuffix, lastUpdate: Date.now() });
            saveData();
            alert("ƒê√£ c·∫≠p nh·∫≠t kho l∆∞u tr·ªØ!");
        }

        // ... (Gi·ªØ nguy√™n c√°c h√†m: saveData, togglePlay, travelTime t·ª´ V12) ...
        function saveData() { localStorage.setItem('brain_v13_nodes', JSON.stringify(nodes.get())); localStorage.setItem('brain_v13_edges', JSON.stringify(edges.get())); }
    </script>
</body>
</html>
